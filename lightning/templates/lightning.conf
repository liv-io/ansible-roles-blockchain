{{ansible_managed|comment(decoration='#')}}

###
## Core Lightning Configurations
###
## Edit this file to your desired configurations
## Uncomment any settings you wish to configure
###
## Copy this file to the root directory  `~.lightning`
## Or a network directory such as `~.lightning/bitcoin`
## Edit this files name to `config`
###
## To view all documentation & options run:
## `man lightningd config`
###


##
# General Settings
##

## Give your node a name
{% if not (lightning_alias == '') %}
alias={{lightning_alias}}
{% endif %}

## Pick your favorite color as a hex code
{% if not (lightning_rgb == '') %}
rgb={{lightning_rgb}}
{% endif %}

## Set the network for Core Lightning to sync to, Bitcoin Mainnet for most users
## Not required if the config file is in a network directory
network=bitcoin

## Run `lightningd` as a background daemon instead of in the terminal
## Requires `log-file` path
daemon

## Log output to specified file instead of the terminal
## Required for `daemon`
log-file={{file_dst_lightningd_log_dir}}/lightningd.log

## Set to debug for more verbose log output
log-level=info

## prefix log messages with timestamp (default: true)
log-timestamps=true

## Password encrypt your `hsm_secret`
## You must supply the password on startup if you choose to do this
{% if (lightning_encrypted_hsm == True) %}
encrypted-hsm
{% endif %}


##
# Networking Settings
##

## INBOUND connections - default PORT 9735
## 0.0.0.0 for clearnet | localhost+torhiddenservice for tor
{% if not (lightning_addr == '') %}
addr={{lightning_addr}}
{% endif %}

## Peers can find your node here
#announce-addr=<IP/TOR ADDRESS>:9735

## Bind Core Lightning RPC server to localhost PORT 9734
{% if not (lightning_bind_addr == '') %}
bind-addr={{lightning_bind_addr}}
{% endif %}

## Configure proxy/tor for OUTBOUND connections.
#proxy=127.0.0.1:9050

## Force all outbound connections through the proxy/tor
#always-use-proxy=false

## Set an IP address (v4 or v6) or .onion v3 to announce, but not listen on
{% if not (lightning_announce_addr == '') %}
announce-addr={{lightning_announce_addr}}
{% endif %}

## Explicitly turns IP discovery 'on' or 'off'. (default: auto)
{% if not (lightning_announce_addr_discovered == '') %}
announce-addr-discovered={{lightning_announce_addr_discovered}}
{% endif %}

## Sets the public TCP port to use for announcing discovered IPs. (default: 9735)
{% if not (lightning_announce_addr_discovered_port == '') %}
announce-addr-discovered-port={{lightning_announce_addr_discovered_port}}
{% endif %}


##
# Channel Settings
# !! Please read the manual before editing these !!
# !!  and for a full list of available options   !!
##

## Removes capacity limit for channel creation
#large-channels

## Base fee to charge for every payment which passes through in MILLISATOSHI (1/1000 of a satoshi)
#fee-base=1000

## In millionths (10 is 0.001%, 100 is 0.01%, 1000 is 0.1% etc.)
#fee-per-satoshi=10

## Minimum value, in SATOSHI, to accept for channel open requests
#min-capacity-sat=10000

## Sets the minimum HTLC value for new channels
#htlc-minimum-msat=0

## Blockchain confirmations required for channel to be considered valid
#funding-confirms=3

## Max number of HTLC channels can handle in each direction
#max-concurrent-htlcs=30

##
# Plugins
# Plugins allow you to extend Core Lightnings functionality
# For a community curated list of available plugins visit:
# "https://github.com/lightningd/plugins"
##

## Load your plugins from a directory
#plugin-dir=/path/to/your/.lightning/plugins

## Load plugins individually
#plugin=path/to/plugin


##
# Bitcoin Settings
##

## bitcoin-cli pathname
bitcoin-cli={{lightning_bitcoin_cli}}

## datadir arg for bitcoin-cli
bitcoin-datadir={{file_dst_bitcoin_cli_dir}}

## bitcoind RPC username
{% if not (lightning_bitcoin_rpcuser == '') %}
bitcoin-rpcuser={{lightning_bitcoin_rpcuser}}
{% endif %}

## bitcoind RPC password
{% if not (lightning_bitcoin_rpcpassword == '') %}
bitcoin-rpcpassword={{lightning_bitcoin_rpcpassword}}
{% endif %}

## bitcoind RPC host to connect to
{% if not (lightning_bitcoin_rpcconnect == '') %}
bitcoin-rpcconnect={{lightning_bitcoin_rpcconnect}}
{% endif %}

## bitcoind RPC host's port
{% if not (lightning_bitcoin_rpcport == '') %}
bitcoin-rpcport={{lightning_bitcoin_rpcport}}
{% endif %}


#--wallet <arg>                                    Location of the wallet database.
#--min-capacity-sat <arg>                          Minimum capacity in satoshis for accepting channels (default: 10000)

#--funder-policy <arg>                             Policy to use for dual-funding requests. [match, available, fixed]
#--funder-policy-mod <arg>                         Percent to apply policy at (match/available); or amount to fund (fixed)
#--funder-min-their-funding <arg>                  Minimum funding peer must open with to activate our policy
#--funder-max-their-funding <arg>                  Maximum funding peer may open with to activate our policy
#--funder-per-channel-min <arg>                    Minimum funding we'll add to a channel. If we can't meet this, we don't fund
#--funder-per-channel-max <arg>                    Maximum funding we'll add to a channel. We cap all contributions to this
#--funder-reserve-tank <arg>                       Amount of funds we'll always leave available.
#--funder-fuzz-percent <arg>                       Percent to fuzz the policy contribution by. Defaults to 0%. Max is 100%
#--funder-fund-probability <arg>                   Percent of requests to consider. Defaults to 100%. Setting to 0% will disable dual-funding
#--funder-lease-requests-only <arg>                Only fund lease requests. Defaults to true if channel lease rates are being advertised
#--lease-fee-base-sat <arg>                        Channel lease rates, base fee for leased funds, in satoshi.
#--lease-fee-basis <arg>                           Channel lease rates, basis charged for leased funds (per 10,000 satoshi.)
#--lease-funding-weight <arg>                      Channel lease rates, weight we'll ask opening peer to pay for in funding transaction
#--channel-fee-max-base-msat <arg>                 Channel lease rates, maximum channel fee base we'll charge for funds routed through a leased channel.
#--channel-fee-max-proportional-thousandths <arg>  Channel lease rates, maximum proportional fee (in thousandths, or ppt) we'll charge for funds routed through a leased channel. Note: 1ppt = 1,000ppm
